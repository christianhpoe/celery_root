<!--
SPDX-FileCopyrightText: 2026 Christian-Hauke Poensgen
SPDX-FileCopyrightText: 2026 Maximilian Dolling
SPDX-FileContributor: AUTHORS.md

SPDX-License-Identifier: BSD-3-Clause
-->

{% extends "base.html" %}
{% load static %}

{% block content %}
  <header class="page-section-header">
    <div>
      <p class="eyebrow">Operations</p>
      <h2>Application logs</h2>
      <p>Live tail of {{ log_dir }}.</p>
    </div>
  </header>

  <section class="detail-card" data-log-panel="true">
    <form method="get" class="filter-panel" data-auto-submit="true">
      <div>
        <label for="log-component">Component</label>
        <select id="log-component" name="component">
          {% if components %}
            {% for name in components %}
              <option value="{{ name }}" {% if name == selected_component %}selected{% endif %}>{{ name }}</option>
            {% endfor %}
          {% else %}
            <option value="">No log files found</option>
          {% endif %}
        </select>
      </div>
      <div>
        <label for="log-lines">Lines</label>
        <input id="log-lines" name="lines" type="number" min="1" max="5000" value="{{ lines }}" />
      </div>
      <div class="filter-actions">
        <button class="btn accent" type="submit">Refresh logs</button>
      </div>
    </form>

    <p class="detail-runtime{% if not error %} is-hidden{% endif %}" data-log-error>
      {% if error %}{{ error }}{% endif %}
    </p>

    <p class="detail-runtime{% if not selected_file %} is-hidden{% endif %}" data-log-file>
      {% if selected_file %}Reading {{ selected_file }}{% endif %}
    </p>

    <pre class="log-output{% if not content %} is-hidden{% endif %}" data-log-output>{% if content %}{{ content }}{% endif %}</pre>
    <p class="detail-runtime{% if content or error %} is-hidden{% endif %}" data-log-empty>No log content available.</p>
  </section>
{% endblock %}

{% block scripts %}
  <script src="{% static 'js/logs.js' %}" defer></script>
{% endblock %}
